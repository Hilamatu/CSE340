<% if (title) { %>
<h1><%=title%></h1>
<%
} else {
    res.redirect('/')
} %>
<%- messages() %>
<% if (errors) { %>
  <ul class="notice">
 <% errors.array().forEach(error => { %> <%#eat the errors variable as an array and loop through the array, with each individual error being sent into a callback function.#%>
   <li><%= error.msg %></li>
<%  }) %>
 </ul>
<% } %>

<div class="form-wrapper">
    <div class="form-container">
      <p>All fiels are required</p>
        <form id="updateForm" class="form-grid" action="/account/update" method="POST">
            <label for="fname">First Name:</label>
            <input type="text" id="fname" name="account_firstname" required value="<%= locals.account_firstname %>"> <%# value makes the form sticky #%>

            <label for="lname">Last Name:</label>
            <input type="text" id="lname" name="account_lastname" required value="<%= locals.account_lastname %>">

            <label for="email">Email Address:</label>
            <input type="email" id="email" name="account_email" required value="<%= locals.account_email %>">


            <input disabled class="update-button" type="submit" value="Update">
            <input type="hidden" name="account_id"
                <% if(locals.account_id) { %> value="<%= locals.account_id %>"
                <% } %>> <!--Add the inventory ID that was retrieved from the data base but not included in the page-->
        </form>
    </div>
</div>


<!--Form to update the password-->
<div class="form-wrapper">
    <div class="form-container">
      <p>By entering a new password it will change the current password</p>
        <form class="form-grid" action="/account/update-password" method="POST">
            <label for="password">Password:</label>
            <span class="password-requirement">Passwords must be minimum of 12 characters and include 1 capital letter, 1 number and 1 special character</span>                                              <!--At least one capital letter, special character and number-->
            <input type="password" id="password" name="account_password" minlength="12" pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\\s).{12,}$" required>
            <span id="pswdBtn">Show Password</span>
            
            <input class="update-button" type="submit" value="Update Password">
            <input type="hidden" name="account_id"
                <% if(locals.account_id) { %> value="<%= locals.account_id %>"
                <% } %>> <!--Add the inventory ID that was retrieved from the data base but not included in the page-->

        </form>
    </div>
</div>
<script src="../../js/account-update.js"></script>
<!-- JS to show the password -->
<script>
  const pswdBtn = document.querySelector("#pswdBtn");
  pswdBtn.addEventListener("click", function() {
    const pswdInput = document.getElementById("password");
    const type = pswdInput.getAttribute("type");
    if (type === "password") {
      pswdInput.setAttribute("type", "text");
      pswdBtn.innerHTML = "Hide Password";
    } else {
      pswdInput.setAttribute("type", "password");
      pswdBtn.innerHTML = "Show Password";
    }
  });
</script>
